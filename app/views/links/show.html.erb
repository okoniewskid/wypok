<%= stylesheet_link_tag "/assets/avatar.css" %>
<%= stylesheet_link_tag "/assets/miniature.css" %>
<%= stylesheet_link_tag "/assets/pagination.css" %>
<%= stylesheet_link_tag "/assets/link.css" %>

<div class="page-header">
  <h1>
    <a href="<%= @link.url %>", target="_blank"><%= @link.title %></a>
    <%= @link.ci_lower_bound(@link.get_upvotes.size, @link.get_upvotes.size+@link.get_downvotes.size, 0.95) %>%
    <br>
    <%= sanitize @link.description, tags: %w(b i u s a br) %>
    <br>
    <a href="<%= @link.url %>" target="_blank" title="<%= @link.title %>" ><img src="<%= @link.generate_image(@link) %>" class="miniaturka" ></a>
    <br>
    <small>Przesłane <strong><%= time_ago_in_words(@link.created_at) %></strong> temu przez <%= link_to @link.user.name, @link.user %></small>
  </h1>
</div>

<div class="btn-group">
	<%= link_to 'Podgląd', @link.url, class: "btn btn-primary", target: "_blank" %>
</div>

<% if user_signed_in? %>
  <div class="btn-group pull-right">
    <%= link_to like_link_path(@link), method: :put, class: "btn btn-default btn-sm" do %>
      <span class="glyphicon glyphicon-chevron-up"></span>
      <%= @link.get_upvotes.size %>
    <% end %>
    <%= link_to dislike_link_path(@link), method: :put, class: "btn btn-default btn-sm" do %>
      <span class="glyphicon glyphicon-chevron-down"></span>
      <%= @link.get_downvotes.size %>
    <% end %>
  </div>
<% end %>

<% if @crud %>
	<div class="btn-group">
		<%= link_to 'Edytuj', edit_link_path(@link), class: "btn btn-default" %>
		<%= link_to 'Usuń', @link, method: :delete, data: { confirm: 'Na pewno?' }, class: "btn btn-default" %>
	</div>
<% end %>

<%= form_tag(@link, :method => "get") do %>
  <% if @sd %>
    <button type="submit" class="btn-link" name="sortDate" value="asc">Sortuj wg daty (rosnąco)</button></br>
  <% else %>
    <button type="submit" class="btn-link" name="sortDate" value="desc">Sortuj wg daty (malejąco)</button></br>
  <% end %>
<% end %>

<h3 class="comments_title">
  <%= @comments.count %> <%= @jakiKom %>
</h3>

<% if user_signed_in? %>
  <%= simple_form_for [@link, Comment.new]  do |f| %>
    <div class="field">
      <%= f.text_area :body, id: "BIUSText",  class: "form-control", required: true %>
      <a id="boldButtom" class="btn btn-default" title="Pogrubienie"><span class="fa fa-bold"></span></a>
      <a id="italicButtom" class="btn btn-default" title="Kursywa"><span class="fa fa-italic"></span></a>
      <a id="underlineButtom" class="btn btn-default" title="Podkreślenie"><span class="fa fa-underline"></span></a>
      <a id="strikethroughButtom" class="btn btn-default" title="Przekreślenie"><span class="fa fa-strikethrough"></span></a>
      <a class="btn btn-default" href="/pages/emoticons.html" target="_blank" title="Dostępne emotikony"><span class="fa fa-smile-o"></span></a>
    </div>
    <br>
    <%= f.submit "Dodaj komentarz", class: "btn btn-primary" %>
  <% end %>  
<% end %>
<br>
<div id="comments">
  <%= render :partial => @comments %>
</div>
<div id="infinite-scrolling">
  <%= will_paginate @comments, renderer: BootstrapPagination::Rails  %>
</div>

<%= javascript_include_tag "/assets/bius.js" %>
<%= javascript_include_tag "/assets/pagination.js" %>